<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>添加图片</title>
      <link href="/posts/37ae.html"/>
      <url>/posts/37ae.html</url>
      
        <content type="html"><![CDATA[<h2 id="图片添加"><a href="#图片添加" class="headerlink" title="图片添加"></a>图片添加</h2><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;更新图片&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>你好，世界</title>
      <link href="/posts/ee58.html"/>
      <url>/posts/ee58.html</url>
      
        <content type="html"><![CDATA[<h2 id="你好！世界"><a href="#你好！世界" class="headerlink" title="你好！世界"></a>你好！世界</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">mv</span> <span class="string">/etc/yum.repo.d/*</span> <span class="string">/home</span></span><br><span class="line"><span class="string">vi</span> <span class="string">/etc/yum.repo.d/a.repo</span></span><br></pre></td></tr></table></figure><p>在repo里加入</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[a]</span><br><span class="line">name=a</span><br><span class="line">baseurl=file:///media</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><h2 id="保存退出wq"><a href="#保存退出wq" class="headerlink" title="保存退出wq"></a>保存退出wq</h2><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /media</span><br><span class="line">yum install -y libvirt virt-install qemu-kvm vim</span><br><span class="line">systemctl start libvirtd.service</span><br><span class="line">systemctl status libvirtd.service</span><br><span class="line">systemctl firewall firewalld </span><br><span class="line">systemctl disable firewalld </span><br><span class="line">virt-install --virt-type kvm --os-type=linux --os-variant rhel7 --name centos7 --memory 1024 --vcpus 1 --disk /opt/centos.raw,format=raw,size=10 --cdrom /opt/CentOS-7-x86<span class="emphasis">_64-DVD-1810.iso --network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole</span></span><br></pre></td></tr></table></figure><h2 id="在vnc连接虚拟机安装虚拟机，过程省略"><a href="#在vnc连接虚拟机安装虚拟机，过程省略" class="headerlink" title="在vnc连接虚拟机安装虚拟机，过程省略"></a>在vnc连接虚拟机安装虚拟机，过程省略</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">virsh list --all</span><br><span class="line">virsh destroy centos7</span><br><span class="line">virsh domrename centos7 ao</span><br><span class="line">virsh list --all</span><br><span class="line">cd /opt</span><br><span class="line">qemu-img convert -f raw -O qcow2 centos.raw centos.qcow2</span><br><span class="line">virsh edit ao</span><br></pre></td></tr></table></figure><h2 id="更改以下内容"><a href="#更改以下内容" class="headerlink" title="更改以下内容"></a>更改以下内容</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;devices&gt;</span><br><span class="line">   &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line">   &lt;disk type=&#x27;file&#x27; device=&#x27;disk&#x27;&gt;</span><br><span class="line">     &lt;driver name=&#x27;qemu&#x27; type=&#x27;qcow2&#x27;/&gt; #raw改成qcow2</span><br><span class="line">     &lt;source file=&#x27;/opt/centos.qcow2&#x27;/&gt; #raw改成qcow2</span><br><span class="line">     &lt;target dev=&#x27;vda&#x27; bus=&#x27;virtio&#x27;/&gt;</span><br><span class="line">     &lt;address type=&#x27;pci&#x27; domain=&#x27;0x0000&#x27; bus=&#x27;0x00&#x27; slot=&#x27;0x06&#x27; function=&#x27;0x0&#x27;/&gt;</span><br><span class="line">   &lt;/disk&gt;</span><br></pre></td></tr></table></figure><h2 id="开机验证-virsh-start-ao"><a href="#开机验证-virsh-start-ao" class="headerlink" title="开机验证  virsh start ao"></a>开机验证  virsh start ao</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">virsh snapshot-create-as ao</span><br><span class="line">virsh snapshot-list ao </span><br><span class="line">virsh snapshot-revert ao 167093632 </span><br><span class="line">virsh snapshot-delete ao --snapshotname 1670936324</span><br></pre></td></tr></table></figure><h2 id="自动化克隆完整虚拟机web01"><a href="#自动化克隆完整虚拟机web01" class="headerlink" title="自动化克隆完整虚拟机web01"></a>自动化克隆完整虚拟机web01</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">virt-clone --auto-clone -o ao -n web01</span><br><span class="line">ll -h</span><br><span class="line">virsh dumpxml web01|grep qcow2</span><br></pre></td></tr></table></figure><h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /server/scripts</span><br><span class="line">cd /server/scripts</span><br><span class="line">vim link_clone.sh</span><br></pre></td></tr></table></figure><h2 id="内容如下"><a href="#内容如下" class="headerlink" title="内容如下"></a>内容如下</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">new_vm=$1</span><br><span class="line">qemu-img create -f qcow2 -b /opt/centos.qcow2 /opt/$&#123;new_vm&#125;.qcow2</span><br><span class="line">virsh dumpxml ao &gt;/tmp/$&#123;new_vm&#125;.xml</span><br><span class="line">sed -ri &quot;s#(&lt;name&gt;)(.*)(&lt;/name&gt;)#\1$&#123;new_vm&#125;\3#g&quot; /tmp/$&#123;new_vm&#125;.xml</span><br><span class="line">sed -i &#x27;/&lt;uuid&gt;/d&#x27; /tmp/$&#123;new_vm&#125;.xml</span><br><span class="line">sed -i &#x27;/&lt;mac address/d&#x27; /tmp/$&#123;new_vm&#125;.xml</span><br><span class="line">sed -ri &quot;s#(&lt;source file=&#x27;)(.*)(&#x27;/&gt;)#\1/opt/$&#123;new_vm&#125;.qcow2\3#g&quot; /tmp/$&#123;new_vm&#125;.xml</span><br><span class="line">virsh define /tmp/$&#123;new_vm&#125;.xml</span><br><span class="line">virsh start $&#123;new_vm&#125;</span><br></pre></td></tr></table></figure><h2 id="sh-link-clone-sh-新名字"><a href="#sh-link-clone-sh-新名字" class="headerlink" title="sh link_clone.sh 新名字"></a>sh link_clone.sh 新名字</h2>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
